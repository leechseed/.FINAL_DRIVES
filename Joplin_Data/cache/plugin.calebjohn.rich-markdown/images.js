(()=>{"use strict";var e={636:function(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{l(n.next(e))}catch(e){o(e)}}function c(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,c)}l((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.clearAllWidgets=t.refreshResource=t.afterSourceChanges=t.onSourceChanged=t.isSupportedOcrMimeType=t.isSupportedImageMimeType=t.html_image_line_regex=t.image_inline_regex=t.image_line_link_regex=t.image_line_regex=void 0;const i=r(853),o=r(996);t.image_line_regex=/^\s*!\[([^\]]*)\]\((<[^\)]+>|[^)\s]+)[^)]*\)({width=(\d+(px|%)?)})?\s*$/,t.image_line_link_regex=/^\[(!\[.*)\]\((.*)\)$/,t.image_inline_regex=/!\[([^\]]*)\]\((<[^\)]+>|[^)\s]+)[^)]*\)({width=(\d+(px|%)?)})?/g,t.html_image_line_regex=/^\s*<img([^>]+?)\/?>\s*$/;let s={};function c(e){return["image/png","image/jpg","image/jpeg"].includes(e.toLowerCase())}function l(e){return function(r){return n(this,void 0,void 0,(function*(){if(!r.target)return;if(!e.state.richMarkdown)return;if(!e.state.richMarkdown.settings.imageHover)return;if(!e.state.richMarkdown.settings.imageHoverCtrl&&(!r.ctrlKey&&!r.altKey||e.state.richMarkdown.isMouseHovering))return;e.state.richMarkdown.isMouseHovering=!0;const s=r.target;if(!s.offsetParent)return;if(e.state.richMarkdown.settings.inlineImages&&s.parentNode.childNodes.length<=3)return;const c=yield function(e,r){return n(this,void 0,void 0,(function*(){let{line:n,ch:s}=r;const c=e.getLine(n),l=i.getMatchAt(c,t.image_inline_regex,s);let g=null;if(l)g=yield u(l[2],l[1],e.state.richMarkdown.path_from_id,l[4],l[5]);else{const t=i.getMatchAt(c,o.html_image_regex,s);t&&(g=yield h(t[0],e.state.richMarkdown.path_from_id))}return g}))}(e,i.getClickCoord(e,r));if(c){if(c.style.zoom){let e=parseFloat(c.style.zoom);c.style.zoom.endsWith("%")&&(e/=100),e&&(c.width*=e,c.height*=e,c.style.zoom="100%")}c.style.visibility="hidden",s.offsetParent.appendChild(c),c.style.position="absolute",c.style.zIndex="1000",c.classList.add("rich-markdown-hover-image"),c.onload=function(){if(!e.state.richMarkdown)return;if(!e.state.richMarkdown.isMouseHovering)return void c.remove();let t=this;const n=s.offsetParent,{right:i,width:o}=n.getBoundingClientRect();let l=0;t.clientWidth<o&&(l=Math.min(r.clientX,i-t.clientWidth));const g=e.coordsChar({left:l,top:r.clientY},"page");t.style.visibility="visible",e.addWidget(g,c,!1)}}}))}}function g(e){const t=e.getWrapperElement().getElementsByClassName("rich-markdown-hover-image");for(let e=t.length-1;e>=0;e--)t[e].remove()}function a(e){return function(t){e.state.richMarkdown&&(e.state.richMarkdown.isMouseHovering=!1),g(e)}}function h(e,t){return n(this,void 0,void 0,(function*(){const r=(new DOMParser).parseFromString(e,"text/html").body.firstChild;r.style.height=r.style.height||"auto",r.style.maxWidth=r.style.maxWidth||"100%";const n=["script","noscript","iframe","frameset","frame","object","base","embed","link","meta"];for(let e=0;e<r.attributes.length;e++){const t=r.attributes[e].name;(n.includes(t)||t.startsWith("on"))&&(r.attributes[e].value="")}if(r.src.length>=34){const e=r.src.substring(r.src.length-34);e.startsWith(":/")&&(r.src=yield t(e.substring(2)),r.id=e.substring(2))}return r}))}function u(e,t,r,i,o,s,c){return n(this,void 0,void 0,(function*(){let n=e.substring(2);e.startsWith(":/")&&34==e.length&&(e=yield r(n)),e.startsWith("<")&&e.endsWith(">")&&(e=e.substring(1,e.length-1));const l=document.createElement("img");return l.src=e,l.alt=t,l.style.maxWidth="100%",l.style.height="auto",c&&s&&(l.onclick=()=>{s.postMessage({name:"followLink",url:c})}),i&&(l.style.width=i+(o?"":"px")),l.id=n,l}))}t.isSupportedImageMimeType=c,t.isSupportedOcrMimeType=function(e){return["application/pdf"].includes(e.toLowerCase())||c(e)},t.onSourceChanged=function(e,r,i,o){e.state.richMarkdown&&e.state.richMarkdown.settings.inlineImages&&function(e,r,i,o){var c,l,g;n(this,void 0,void 0,(function*(){if(!e.state.richMarkdown)return;const n=e.state.richMarkdown.path_from_id;let a=!1;for(let _=r;_<=i;_++){const r=e.lineInfo(_);if(r.widgets)for(const e of r.widgets)"rich-markdown-resource"===e.className&&e.clear(),delete s[e.node.id];if(!r)continue;const i=e.getStateAfter(_,!0);if((null==i?void 0:i.outer)&&((null===(c=null==i?void 0:i.outer)||void 0===c?void 0:c.code)||(null===(g=null===(l=null==i?void 0:i.outer)||void 0===l?void 0:l.thisLine)||void 0===g?void 0:g.fencedCodeEnd)))continue;const d=r.text.match(t.image_line_link_regex);let x=r.text,m="";d&&(x=d[1],m=d[2]);const k=x.match(t.image_line_regex);let f=null;if(k)f=yield u(k[2],k[1],n,k[4],k[5],o,m);else{const e=r.text.match(t.html_image_line_regex);e&&(f=yield h(e[0],n))}if(f){const t=e.addLineWidget(_,f,{className:"rich-markdown-resource"});s[f.id]=t,a=!0}}a&&e.refresh()}))}(e,r,i,o)},t.afterSourceChanges=function(e){e.state.richMarkdown&&e.state.richMarkdown.settings.imageHover&&function(e){if(!e.state.richMarkdown)return;g(e);const t=e.getWrapperElement().getElementsByClassName("cm-rm-image");for(let r of t)r.onmouseenter=l(e),r.onmouseleave=a(e),e.state.richMarkdown.settings.imageHoverCtrl||(r.onmousemove=l(e))}(e)},t.refreshResource=function(e,t){const r=(new Date).getTime();let n=s[t];const i=n.node.src.split("?t=")[0],o=n.node.height;n.node.onload=function(){0!=this.getClientRects().length&&this.height!=o&&e.refresh()},n.node.src=`${i}?t=${r}`},t.clearAllWidgets=function(e){g(e);for(let e in s)s[e].clear();s={},e.refresh()}},853:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.toggleCheckbox=t.getItemsAt=t.TextItemType=t.clickAt=t.getClickCoord=t.getMatchAt=t.isCheckbox=t.isLink=void 0;const n=r(996);function i(e,t,r){let n=null;if(t.lastIndex=0,!t.global)return console.error("getMatchAt requires a global regex; Consider adding a `g` after ${regex}"),null;do{if(n=t.exec(e),!n)break;const i=n.index,o=i+n[0].length;if(i<=r&&r<=o)return n}while(n);return null}var o;function s(e,t){let{line:r,ch:o}=t;const s=e.getLine(r),c=i(s,n.link_regex,o);let l="";if(c)for(let e=1;e<=4;e++)l=l||c[e];else{const t=i(s,n.link_reference_regex,o);if(!t)return;const r=t[1]||t[2];if(""===r.trim()||"x"===r.toLowerCase())return;const c=new RegExp(`\\[${r}\\]:\\s([^\\n]+)`,"g");for(let t=0;t<e.lineCount();t++){const r=i(e.getLine(t),c,4);if(r){l=r[1];break}}if(""===l)return void alert(`No link defintion for [${r}]. Press Esc to dismiss.`)}return l&&l.endsWith(")")?i(s,n.image_regex,o)&&(l=l.slice(0,l.length-1)):l&&(l.endsWith('"')||l.endsWith("'"))&&(l=l.slice(0,l.length-1)),l=l.split(" ")[0],l}function c(e,t){const{line:r,ch:o}=t,s=e.getLine(r),c=i(s,n.checkbox_regex,o);return c&&c[3]?{match:c,lineText:s,line:r}:null}function l(e,t,r){const n=e.getCursor(),i=c(e,t);if(!i)return!1;const{match:o,line:s,lineText:l}=i;let g=l.indexOf(o[3]),a=g+o[3].length,h=r;return""===h&&(h=" "===o[3][1]?"[x]":"[ ]"),e.replaceRange(h,{ch:g,line:s},{ch:a,line:s},"+input"),e.setCursor(n,null,{scroll:!1}),!0}function g(e,t,r){if(!e.somethingSelected())return l(e,t,r);for(let t of e.listSelections()){let n,i;t.anchor.line>t.head.line?(n=t.head,i=t.anchor):(n=t.anchor,i=t.head);for(let t=n.line;t<=i.line;t++)l(e,{line:t,ch:0},r)}return!0}t.isLink=function(e){if(!e.target)return!1;const t=e.target;return t.matches(".cm-rm-link *, .cm-rm-link")||t.matches(".cm-rm-link-label")},t.isCheckbox=function(e){return!!e.target&&e.target.matches(".cm-rm-checkbox *, .cm-rm-checkbox")},t.getMatchAt=i,t.getClickCoord=function(e,t){return(r=e.coordsChar({left:t.clientX,top:t.clientY})).sticky&&"before"===r.sticky?{ch:r.ch-1,line:r.line}:r;var r},t.clickAt=function(e,t){if(!e.state.richMarkdown)return;const r=e.state.richMarkdown.settings;if(r.links){const r=s(e,t);if(r)return{name:"followLink",url:r}}return r.checkbox&&g(e,t,""),null},function(e){e.Link="link",e.Checkbox="checkbox"}(o=t.TextItemType||(t.TextItemType={})),t.getItemsAt=function(e,t){if(!e.state.richMarkdown)return null;const r=e.state.richMarkdown.settings;let n=[];if(r.links){const r=s(e,t);r&&n.push({type:o.Link,url:r,coord:t})}return r.checkbox&&c(e,t)&&n.push({type:o.Checkbox,coord:t}),n},t.toggleCheckbox=g},996:(e,t)=>{function r(e,t,r){const n=e.indexOf("tick")>0;return{name:"RichMarkdownOverlay-"+e,requiredSettings:r,token:function(r){const i=function(e,t){return e.lastIndex=t.pos,e.exec(t.string)}(t,r),o=r.baseToken();if((null==o?void 0:o.type)&&(!n&&(o.type.includes("jn-inline-code")||o.type.includes("comment"))||o.type.includes("katex")))r.pos+=o.size;else{if(i&&i.index===r.pos)return r.pos+=i[0].length||1,e;i?r.pos=i.index:r.skipToEnd()}return null}}}function n(e,t){for(let r of t)if(!e[r]&&("extraCSS"!==r||"none"===e.theme&&!e.extraFancy))return!1;return!0}Object.defineProperty(t,"__esModule",{value:!0}),t.remove=t.add=t.overlays=t.regexOverlay=t.table_regex=t.blockquote_regex=t.hr_regex=t.list_token_regex=t.header_regex=t.admonition_line_regex=t.admonition_token_regex=t.backtick_block_token_regex=t.backtick_token_regex=t.strike_token_regex=t.sup_token_regex=t.sub_token_regex=t.insert_token_regex=t.highlight_token_regex=t.strong_underline_regex=t.strong_star_regex=t.emph_underline_regex=t.emph_star_regex=t.sup_regex=t.sub_regex=t.insert_regex=t.highlight_regex=t.html_image_regex=t.image_regex=t.link_label_regex=t.link_reference_regex=t.link_regex=t.checkbox_inner_checked_regex=t.checkbox_inner_regex=t.checkboxed_regex=t.checkbox_regex=void 0,t.checkbox_regex=/^(\s*)((?:[\*\+\-\#]|[\#]+) )(\[[Xx ]\])\s.*$/g,t.checkboxed_regex=/^(\s*)((?:[\*\+\-\#]|[\#]+) )(\[[Xx]\])\s.*$/g,t.checkbox_inner_regex=/(?<=\[)[Xx ](?=\])/g,t.checkbox_inner_checked_regex=/(?<=\[)[Xx](?=\])/g,t.link_regex=/(?<![\\])\[[^\]]*\]\(([^\(\)]+)\)|<([^>\s]+\.[^>\s]+)>|((?:[a-zA-Z0-9\+\.\-])+:\/\/(?:www\.|(?!www))[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|www\.[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|(?:[a-zA-Z0-9\+\.\-])+:\/\/(?:www\.|(?!www))[a-zA-Z0-9]+\.[^\s]{2,}|www\.[a-zA-Z0-9]+\.[^\s]{2,}[^\)])(?<!\))|joplin:\/\/x-callback-url\/.*/g,t.link_reference_regex=/(?<![\\])\[([^\]]*)\](?!\()|\]\[([^\]]*)\]\s/g,t.link_label_regex=/((?<![\\])\[(?:[^\sxX]|(?:[^\]][^\]]+))\])/g,t.image_regex=/!\[[^\]]*\]\([^\(]+\)/g,t.html_image_regex=/<img([^>]+?)\/?>/g,t.highlight_regex=/(?<!\\)==(?=[^\s])[^=]*[^=\s\\]==/g,t.insert_regex=/(?<!\\)\+\+(?=[^\s])[^\+]*[^\+\s\\]\+\+/g,t.sub_regex=/(?<![\\~])~(?=[^\s])[^~]*[^~\s\\]~/g,t.sup_regex=/(?<![\\[])\^(?=[^\s])[^\^]*[^\^\s\\[]\^/g,t.emph_star_regex=/(?<![\\\*])\*(?!\*)/g,t.emph_underline_regex=/(?<![\\\_])\_(?!\_)/g,t.strong_star_regex=/(?<![\\\*])\*\*(?!\*)/g,t.strong_underline_regex=/(?<![\\\_])\_\_(?!\_)/g,t.highlight_token_regex=/(?<![\\=])==(?!=)/g,t.insert_token_regex=/(?<![\\\+])\+\+(?!\+)/g,t.sub_token_regex=/(?<![\\~])~(?!~)/g,t.sup_token_regex=/(?<![\\\^])\^(?!\^)/g,t.strike_token_regex=/(?<![\\~])~~(?!~~)/g,t.backtick_token_regex=/(?<![\\`])`(?!`)/g,t.backtick_block_token_regex=/^```\S*$/g,t.admonition_token_regex=/^!!!/g,t.admonition_line_regex=/^!!!.*$/g,t.header_regex=/^\s*#+\s/g,t.list_token_regex=/^(\s*)([*+-] \[[Xx ]\]\s|[*+->]\s|(\d+)([.)]\s))(\s*)/g,t.hr_regex=/^([*\-_])(?:\s*\1){2,}\s*$/,t.blockquote_regex=/^\s*\>+\s/g,t.table_regex=/^\|[^\n]+\|/g,t.regexOverlay=r,t.overlays=[r("rm-checkbox",t.checkbox_regex,[]),r("rm-checkboxed",t.checkboxed_regex,["extraCSS"]),r("rm-checkbox-check",t.checkbox_inner_regex,["extraCSS"]),r("rm-checkbox-checked",t.checkbox_inner_checked_regex,["extraCSS"]),r("rm-link",t.link_regex,[]),r("rm-link-label",t.link_label_regex,[]),r("rm-image",t.image_regex,[]),r("rm-image",t.html_image_regex,[]),r("rm-list-token",t.list_token_regex,[]),r("rm-ins",t.insert_regex,["insertHighlight"]),r("rm-sub",t.sub_regex,["subHighlight"]),r("rm-sup",t.sup_regex,["supHighlight"]),r("rm-header-token",t.header_regex,["extraCSS"]),r("line-cm-rm-blockquote",t.blockquote_regex,["extraCSS"]),r("rm-em-token",t.emph_star_regex,["extraCSS"]),r("rm-em-token",t.emph_underline_regex,["extraCSS"]),r("rm-strong-token",t.strong_star_regex,["extraCSS"]),r("rm-strong-token",t.strong_underline_regex,["extraCSS"]),r("rm-highlight",t.highlight_regex,["markHighlight"]),r("rm-highlight-token",t.highlight_token_regex,["extraCSS","markHighlight"]),r("rm-ins-token",t.insert_token_regex,["extraCSS","insertHighlight"]),r("rm-sub-token",t.sub_token_regex,["extraCSS","subHighlight"]),r("rm-sup-token",t.sup_token_regex,["extraCSS","supHighlight"]),r("rm-strike-token",t.strike_token_regex,["extraCSS"]),r("rm-backtick-token",t.backtick_token_regex,["extraCSS"]),r("rm-triptick-token",t.backtick_block_token_regex,["extraCSS"]),r("rm-hr line-cm-rm-hr",t.hr_regex,["extraCSS"]),r("rm-admonition-token line-cm-rm-admonition line-background-cm-rm-admonition",t.admonition_token_regex,["extraCSS"]),r("rm-admonition",t.admonition_line_regex,["extraCSS"])],t.add=function(e){if(e.state.richMarkdown)for(let r of t.overlays)n(e.state.richMarkdown.settings,r.requiredSettings)&&e.addOverlay(r)},t.remove=function(e){for(let r of t.overlays)e.removeOverlay(r)}}},t={},r=function r(n){var i=t[n];if(void 0!==i)return i.exports;var o=t[n]={exports:{}};return e[n].call(o.exports,o,o.exports,r),o.exports}(636);exports.default=r.default})();